webpackJsonp([1],{"+6wc":function(e,t){},CRIZ:function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("7+uW"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var i=r("VU/8")({name:"App"},n,!1,function(e){r("+6wc")},null,null).exports,s=r("/ocq"),l=r("Xxa5"),o=r.n(l),u=r("exGp"),c=r.n(u),p=r("Dd8w"),m=r.n(p),d={data:function(){return{visible:!1,numberTypeList:[],formDialogVisible:!1,newNumberType:{id:null,number:"",name:"",initSerialNumber:null},rules:{number:[{required:!0,message:"序号为必填项",trigger:"blur"}],name:[{required:!0,message:"名称为必填项",trigger:"blur"}],initSerialNumber:[{required:!0,message:"初始值为必填项",trigger:"blur"}]},currentRow:null,page:{currPage:1,size:10,total:0}}},methods:{openEditDialog:function(e){this.newNumberType=m()({},e),this.formDialogVisible=!0},deleteSelected:function(e){var t=this;return c()(o.a.mark(function r(){var a;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$http.post("/api/number/type/delete",e);case 3:if(!(a=r.sent)||0!==a.data.code){r.next=8;break}return t.$message.success("删除成功"),r.next=8,t.getNumberTypeList();case 8:r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),t.$message.error("删除失败："+r.t0.message);case 13:case"end":return r.stop()}},r,t,[[0,10]])}))()},handleTableCurrentChange:function(e){this.currentRow=e},openFormDialog:function(){this.newNumberType={id:null,number:"",name:""},this.currentRow=null,this.formDialogVisible=!0},getNumberTypeList:function(){var e=this;return c()(o.a.mark(function t(){var r,a,n,i,s,l,u;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={page:e.page.currPage+"",limit:e.page.size+""},t.next=4,e.$http.post("/api/number/type/list",r);case 4:(a=t.sent).data&&0===a.data.code&&(n=a.data.page,i=n.currPage,s=n.pageSize,l=n.totalCount,n.totalPage,u=n.list,e.page.currPage=i,e.page.size=s,e.page.total=l,e.numberTypeList=u),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$message.error("数据查询失败："+t.t0.message);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},addNumberType:function(){var e=this;return c()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e.newNumberType.id=null,t.next=4,e.$http.post("/api/number/type/save",e.newNumberType);case 4:(r=t.sent).data&&0===r.data.code&&(e.$message.success("数据添加成功"),e.formDialogVisible=!1,e.getNumberTypeList()),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$message.error("数据添加失败："+t.t0.message);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},updateNumberType:function(){var e=this;return c()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/api/number/type/update",e.newNumberType);case 3:(r=t.sent).data&&0===r.data.code&&(e.$message.success("数据添加成功"),e.formDialogVisible=!1,e.getNumberTypeList()),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("数据添加失败："+t.t0.message);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},save:function(){var e=this;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.$refs.newNumberType.validate(function(t){t&&(null===e.currentRow||null===e.currentRow.id?e.addNumberType():e.updateNumberType())});case 1:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.page.size=e,this.page.currPage=1,this.getNumberTypeList()},handleCurrentPageChange:function(e){this.page.currPage=e,this.getNumberTypeList()}},created:function(){this.getNumberTypeList()}},b={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"table"}},[r("div",{staticClass:"table-header"},[r("el-button",{attrs:{type:"primary",plain:""},nativeOn:{click:function(t){return e.openFormDialog.apply(null,arguments)}}},[e._v("新增")])],1),e._v(" "),r("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.numberTypeList,"highlight-current-row":"",height:"calc(100% - 52px)%",border:""},on:{"current-change":e.handleTableCurrentChange}},[r("el-table-column",{attrs:{prop:"number",label:"序号",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),r("el-table-column",{attrs:{prop:"initSerialNumber",label:"初始值"}}),e._v(" "),r("el-table-column",{attrs:{prop:"created",label:"创建时间",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticStyle:{display:"flex","align-items":"center",gap:"12px"}},[r("el-button",{staticClass:"mr-4",attrs:{type:"primary",plain:""},nativeOn:{click:function(r){return e.openEditDialog(t.row)}}},[e._v("修改")]),e._v(" "),r("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(r){e.$set(t.row,"visible",r)},expression:"scope.row.visible"}},[r("p",[e._v("确认删除？")]),e._v(" "),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini"},nativeOn:{click:function(r){return e.deleteSelected(t.row)}}},[e._v("确定")])],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"primary",plain:""},slot:"reference"},[e._v("删除")])],1)],1)]}}])})],1),e._v(" "),r("el-pagination",{attrs:{"current-page":e.page.currPage,"page-sizes":[10,20,30,50],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentPageChange}}),e._v(" "),r("el-dialog",{attrs:{visible:e.formDialogVisible,title:"表单填写"},on:{"update:visible":function(t){e.formDialogVisible=t}}},[r("el-form",{ref:"newNumberType",attrs:{model:e.newNumberType,rules:e.rules}},[r("el-form-item",{attrs:{label:"序号",required:"",prop:"number"}},[r("el-input",{model:{value:e.newNumberType.number,callback:function(t){e.$set(e.newNumberType,"number",t)},expression:"newNumberType.number"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"名称",required:"",prop:"name"}},[r("el-input",{model:{value:e.newNumberType.name,callback:function(t){e.$set(e.newNumberType,"name",t)},expression:"newNumberType.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"初始值",required:"",prop:"initSerialNumber"}},[r("el-input",{model:{value:e.newNumberType.initSerialNumber,callback:function(t){e.$set(e.newNumberType,"initSerialNumber",t)},expression:"newNumberType.initSerialNumber"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer"},[r("el-button",{on:{click:function(t){e.formDialogVisible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var g=r("VU/8")(d,b,!1,function(e){r("d7pR")},null,null).exports,f={data:function(){return{form:{type:"",corp:"HT",name:"",delivery:!1,router:"0",serialNumber:null,desc:"",imageBase64:""},showDeleteIcon:!1,imageUrl:"",numberTypeList:[],rules:{type:[{required:!0,message:"请选择图纸类型",trigger:"change"}],corp:[{required:!0,message:"公司名称为必填项",trigger:["blur","change"]},{validator:this.checkNotEmpty,trigger:"blur"}],name:[{required:!0,message:"中文名为必填项",trigger:["blur","change"]},{validator:this.checkNotEmpty,trigger:"blur"}],serialNumber:[{required:!0,message:"请先生成流水号",trigger:"change"}]}}},computed:{displaySerialNumber:function(){if(null===this.form.serialNumber)return null;var e=this.form.serialNumber.toString().padStart(4,"0");return"0"===this.form.router?this.form.name+"  "+this.form.type+this.form.corp+e:""+this.form.type+this.form.corp+e+"  "+this.form.name}},methods:{handleImageChange:function(e){var t=this,r=new FileReader;r.onload=function(e){t.imageUrl=e.target.result,t.form.imageBase64=e.target.result},r.readAsDataURL(e.raw)},deleteImage:function(){this.imageUrl="",this.form.imageBase64="",this.showDeleteIcon=!1},checkNotEmpty:function(e,t,r){""===t.trim()?r(new Error("禁止输入空格")):r()},getNumberTypeList:function(){var e=this;return c()(o.a.mark(function t(){var r,a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/api/number/type/list",{});case 3:(r=t.sent).data&&0===r.data.code&&(a=r.data.page.list,e.numberTypeList=a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("数据查询失败："+t.t0.message);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},copyCorpName:function(){var e=this;navigator.clipboard.writeText(this.corpName).then(function(){e.$message.success("复制成功")}).catch(function(t){e.$message.error("复制失败："+t)})},getSerialNumberMax:function(){var e=this;return c()(o.a.mark(function t(){var r,a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.form.type){t.next=4;break}return e.$message.warning("请先选择图纸类型"),t.abrupt("return");case 4:return r={type:e.form.type},t.next=7,e.$http.post("/api/number/data/max",r);case 7:if(!(a=t.sent)||0!==a.data.code){t.next=14;break}return n=Number(a.data.data)+1,e.form.serialNumber=n,t.next=13,navigator.clipboard.writeText(e.displaySerialNumber);case 13:e.$message.success("流水号已生成并复制到剪贴板");case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),e.$message.error("生成失败"+t.t0);case 19:case"end":return t.stop()}},t,e,[[0,16]])}))()},handleSubmit:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return e.$message.error("请正确填写所有必填项"),!1;e.onSubmit()})},onSubmit:function(){var e=this;return c()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/api/number/data/save",e.form);case 3:t.sent,e.$message.success("数据添加成功"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("数据添加失败"+t.t0);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()}},created:function(){this.getNumberTypeList()}},v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"类型",required:""}},[r("el-select",{attrs:{prop:"type",placeholder:"请选择图纸类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.numberTypeList,function(e){return r("el-option",{key:e._id,attrs:{label:e.number+"——"+e.name,value:e.number}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"公司",prop:"corp",required:""}},[r("el-input",{staticStyle:{width:"30%"},attrs:{placeholder:"请输入公司"},model:{value:e.form.corp,callback:function(t){e.$set(e.form,"corp",t)},expression:"form.corp"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中文名",prop:"name",required:""}},[r("el-input",{staticStyle:{width:"30%"},attrs:{placeholder:"请输入中文"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"中文配置",required:""}},[r("el-radio-group",{model:{value:e.form.router,callback:function(t){e.$set(e.form,"router",t)},expression:"form.router"}},[r("el-radio",{attrs:{label:"0"}},[e._v("前置")]),e._v(" "),r("el-radio",{attrs:{label:"1"}},[e._v("后置")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"图片上传"}},[r("div",{staticClass:"image-upload-wrapper"},[e.imageUrl?r("div",{staticClass:"image-preview-container"},[r("div",{staticClass:"image-preview-wrapper",on:{mouseenter:function(t){e.showDeleteIcon=!0},mouseleave:function(t){e.showDeleteIcon=!1}}},[r("img",{staticClass:"preview-image",staticStyle:{cursor:"pointer"},attrs:{src:e.imageUrl,alt:"预览图"}}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showDeleteIcon,expression:"showDeleteIcon"}],staticClass:"delete-icon",on:{click:e.deleteImage}},[r("i",{staticClass:"fas fa-times"})])])]):r("el-upload",{ref:"uploadInput",staticClass:"image-upload-btn",attrs:{action:"","on-change":e.handleImageChange,"show-file-list":!1}},[r("el-button",{attrs:{type:"primary"}},[e._v("选择图片")])],1)],1)]),e._v(" "),r("el-form-item",{attrs:{label:"流水号",prop:"serialNumber",required:""}},[r("el-input",{staticStyle:{width:"30%"},attrs:{placeholder:"",value:e.displaySerialNumber,disabled:!0}}),e._v(" "),r("el-button",{on:{click:e.getSerialNumberMax}},[e._v("生成流水号")]),e._v(" "),r("el-button",{on:{click:e.copyCorpName}},[e._v("复制")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("立即创建")]),e._v(" "),r("el-button",[e._v("取消")])],1)],1)},staticRenderFns:[]};var h=r("VU/8")(f,v,!1,function(e){r("tXjd")},"data-v-6dde28bb",null).exports,y={props:["number"],data:function(){return{numberDataList:[],currentRow:null,page:{currPage:1,size:10,total:0},tableHeight:"calc(100vh - 180px)"}},computed:{},methods:{deleteSelected:function(e){var t=this;return c()(o.a.mark(function r(){var a;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.$http.post("/api/number/data/delete",e);case 3:if(!(a=r.sent)||0!==a.data.code){r.next=8;break}return t.$message.success("删除成功"),r.next=8,t.selectNumberDataList();case 8:r.next=13;break;case 10:r.prev=10,r.t0=r.catch(0),t.$message.error("删除失败："+r.t0.message);case 13:case"end":return r.stop()}},r,t,[[0,10]])}))()},formatSerialNumber:function(e,t,r){return r.toString().padStart(4,"0")},getRowDisplaySerial:function(e){var t=e.name,r=e.corp,a=e.type,n=e.serialNumber,i=e.router,s=n.toString().padStart(4,"0");return 0===i?t+"  "+a+r+s:""+a+r+s+"  "+t},selectNumberDataList:function(){var e=this;return c()(o.a.mark(function t(){var r,a,n,i,s,l,u;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r={type:e.number,page:e.page.currPage+"",limit:e.page.size+""},t.next=4,e.$http.post("/api/number/data/list",r);case 4:(a=t.sent).data&&0===a.data.code&&(n=a.data.page,i=n.currPage,s=n.pageSize,l=n.totalCount,n.totalPage,u=n.list,e.page.currPage=i,e.page.size=s,e.page.total=l,e.numberDataList=u),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.$message.error("数据查询失败"+t.t0);case 11:case"end":return t.stop()}},t,e,[[0,8]])}))()},handleSizeChange:function(e){this.page.size=e,this.page.currPage=1,this.selectNumberDataList()},handleCurrentPageChange:function(e){this.page.currPage=e,this.selectNumberDataList()}},created:function(){this.selectNumberDataList()}},w={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"table"}},[r("el-table",{ref:"singleTable",staticStyle:{width:"100%"},attrs:{data:e.numberDataList,"highlight-current-row":"",height:"100%",border:""}},[r("el-table-column",{attrs:{prop:"type",label:"类型",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"corp",label:"公司",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"serialNumber",label:"图号",width:"180",formatter:e.formatSerialNumber}}),e._v(" "),r("el-table-column",{attrs:{prop:"name",label:"中文",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"全名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e.getRowDisplaySerial(t.row))+"\n      ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticStyle:{display:"flex","align-items":"center",gap:"12px"}},[r("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(r){e.$set(t.row,"visible",r)},expression:"scope.row.visible"}},[r("p",[e._v("确认删除？")]),e._v(" "),r("div",{staticStyle:{"text-align":"right",margin:"0"}},[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini"},nativeOn:{click:function(r){return e.deleteSelected(t.row)}}},[e._v("确定")])],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"primary",plain:""},slot:"reference"},[e._v("删除")])],1)],1)]}}])})],1),e._v(" "),r("el-pagination",{staticClass:"mt-4",attrs:{"current-page":e.page.currPage,"page-sizes":[10,20,30,50],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentPageChange}})],1)},staticRenderFns:[]};var _=r("VU/8")(y,w,!1,function(e){r("CRIZ")},null,null).exports,x={data:function(){return{pageName:null,numberTypeList:[],number:"",currentActiveIndex:""}},methods:{handleMenuSelect:function(e){this.pageName={config:g,DataForm:h,NumberData:_}[e]},getNumberTypeList:function(){var e=this;return c()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$http.post("/api/number/type/list",{});case 3:(r=t.sent).data&&0===r.data.code&&(e.numberTypeList=r.data.page.list),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),e.$message.error("数据查询失败："+t.t0.message);case 10:case"end":return t.stop()}},t,e,[[0,7]])}))()},selectNumberData:function(e){this.number=e.number,this.currentActiveIndex=e.number,this.handleMenuSelect("NumberData")}},created:function(){this.getNumberTypeList()}},N={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",{staticStyle:{border:"1px solid #eee"}},[r("el-aside",{staticStyle:{"background-color":"rgb(238, 241, 246)"},attrs:{width:"200px"}},[r("el-menu",{attrs:{"default-openeds":["1","2"],"collapse-on-select":!1},on:{select:e.handleMenuSelect}},[r("el-submenu",{attrs:{index:"1"}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-message"}),e._v("数据填报页")]),e._v(" "),r("el-menu-item",{attrs:{index:"DataForm"}},[e._v("数据填报")]),e._v(" "),r("el-menu-item",{attrs:{index:"config"}},[e._v("配置项")])],2),e._v(" "),r("el-submenu",{attrs:{index:"2"}},[r("template",{slot:"title"},[r("i",{staticClass:"el-icon-menu"}),e._v("数据查看页")]),e._v(" "),e._l(e.numberTypeList,function(t){return r("el-menu-item",{key:t.id,attrs:{index:t.number},on:{click:function(r){return e.selectNumberData(t)}}},[e._v("\n          "+e._s(t.number)+"——"+e._s(t.name)+"\n        ")])})],2)],1)],1),e._v(" "),r("el-container",[r("el-main",[r(e.pageName,{key:e.number,tag:"el-component",attrs:{number:e.number}})],1)],1)],1)},staticRenderFns:[]};var k=r("VU/8")(x,N,!1,function(e){r("vyNa")},null,null).exports;a.default.use(s.a);var S=new s.a({routes:[{path:"/",name:"Main",component:k}]}),T=r("zL8q"),$=r.n(T),C=(r("tvR6"),r("mtWM"));r("jKqc");a.default.config.productionTip=!1,a.default.prototype.$http=C.a,a.default.use($.a),new a.default({el:"#app",router:S,components:{App:i},template:"<App/>"})},d7pR:function(e,t){},jKqc:function(e,t){},tXjd:function(e,t){},tvR6:function(e,t){},vyNa:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.e09468f418ccdb67379f.js.map